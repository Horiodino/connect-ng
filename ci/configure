#!/bin/bash

# Where the connect-ng source is located within the container
SOURCE=${SOURCE:-/usr/src/connect-ng}

# Where is the rpm build environment to be found
BUILD_DIR=${BUILD_DIR:-/usr/src/packages}

group() { echo "::group::$1"; }
groupend() { echo "::groupend::"; }
fail() { echo "::error::$1"; exit 1; }

group "install suseconnect"
pushd "$BUILD_DIR/RPMS/x86_64"
  zypper --non-interactive --no-refresh install --allow-unsigned-rpm *.rpm
popd
groupend

group "install cucumber"
pushd "$SOURCE/features"
  bundle install
popd
groupend
